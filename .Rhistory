RStudio.Version()$version
library(bookdown)
detach("package:bookdown", unload = TRUE)
unit_well_yield <- fread('data/well_yields_virginia.csv')
install.packages("DescTools")
library(data.table)
monthly_streamflow <- fread('data/licking_river_streamflow.csv')
annual_streamflow <- monthly_streamflow[, year_va := mean(mean_va), by = year_nu][,unique(year_va), by = year_nu]
median(annual_streamflow$V1)
annual_streamflow[, idx := as.numeric(row.names(.SD))][, p_i := (idx - 0.4)/(.N + 0.2)]
View(annual_streamflow)
monthly_streamflow <- fread('data/licking_river_streamflow.csv')
annual_streamflow <- monthly_streamflow[, year_va := mean(mean_va), by = year_nu][,unique(year_va), by = year_nu]
setorder(annual_streamflow,V1)
annual_streamflow[, idx := as.numeric(row.names(.SD))][, p_i := (idx - 0.4)/(.N + 0.2)]
View(annual_streamflow)
(25.5 - 0.4)/(50 + 0.2)
annual_streamflow[, zp:= qnorm(p_i, mean(V1), sd(V1))]
View(annual_streamflow)
annual_streamflow[, zp:= qnorm(p_i, 0, 1)]
View(annual_streamflow)
library(ggplot2)
ggplot(annual_streamflow, aes(x = V1, y = p_i)) +
geom_point() +
geom_line() +
geom_line(aes(x = (zp + 3)*8000/6)) +
scale_color_manual(values = palettes_bright$colset_cheer_brights) +
theme_generic +
labs(x = "Streamflow, in cfs", y = "CUMULATIVE FREQUENCY") +
scale_x_continuous(breaks = seq(0, 8000, 1000), limits = c(0, 8000), sec.axis = sec_axis(~ . *6/8000 - 3, name = "Normal Quantiles", breaks = seq(-3, 3, 1))) +
scale_y_continuous(breaks = seq(0, 1, 0.1))
ggplot(annual_streamflow, aes(x = V1, y = p_i)) +
geom_point() +
geom_line() +
geom_line(aes(x = (zp + 3)*8000/6))
unit_well_yield_data <- fread('data/well_yields_virginia.csv')
setorder(unit_well_yield_data,unit_well_yield)
unit_well_yield_data[, idx := as.numeric(row.names(.SD))][, p_i := (idx - 0.4)/(.N + 0.2)][, zp:= qnorm(p_i, 0, 1)]
View(unit_well_yield_data)
unit_well_yield_data[,-idx]
unit_well_yield_data[,idx := NULL]
View(unit_well_yield_data)
unit_well_yield_data <- fread('data/well_yields_virginia.csv')
setorder(unit_well_yield_data,unit_well_yield)
unit_well_yield_data[, idx := as.numeric(row.names(.SD))][, p_i := (idx - 0.4)/(.N + 0.2)][, zp:= qnorm(p_i, 0, 1)][,idx := NULL]
unit_well_yield_data
log10(4000)
4.2-2.8
mean(log10(annual_streamflow$V1))
sd(log10(annual_streamflow$V1))
sd(annual_streamflow$V1)
mean(annual_streamflow$V1)
mean(log10(unit_well_yield_data$unit_well_yield))
mean(unit_well_yield_data$unit_well_yield)
sd(unit_well_yield_data$unit_well_yield)
View(unit_well_yield_data)
View(annual_streamflow)
annual_streamflow_altered <- annual_streamflow
View(annual_streamflow_altered)
annual_streamflow_altered[idx >= 48, V1 = 3*V1]
annual_streamflow_altered[idx >= 48, 3*V1]
annual_streamflow_altered[idx >= 48, V1 := 3*V1]
View(annual_streamflow_altered)
mean(annual_streamflow_altered$V1)
sd(annual_streamflow_altered$V1)
annual_streamflow_altered <- annual_streamflow
annual_streamflow_altered[idx > 48, V1 := 3*V1]
mean(annual_streamflow_altered$V1)
View(annual_streamflow_altered)
View(annual_streamflow_altered)
annual_streamflow_altered <- annual_streamflow
annual_streamflow_altered[idx > 48, V1 := 3*V1]
View(annual_streamflow_altered)
View(annual_streamflow_altered)
annual_streamflow_altered <- annual_streamflow
View(annual_streamflow_altered)
annual_streamflow_altered <- annual_streamflow
View(annual_streamflow)
View(annual_streamflow)
monthly_streamflow <- fread('data/licking_river_streamflow.csv')
annual_streamflow <- monthly_streamflow[, year_va := mean(mean_va), by = year_nu][,unique(year_va), by = year_nu]
setorder(annual_streamflow,V1)
annual_streamflow[, idx := as.numeric(row.names(.SD))][, p_i := (idx - 0.4)/(.N + 0.2)]
annual_streamflow[, zp:= qnorm(p_i, 0, 1)]
View(annual_streamflow)
annual_streamflow_altered <- annual_streamflow
annual_streamflow_altered[idx > 48, V1 := 3*V1]
View(annual_streamflow_altered)
mean(annual_streamflow_altered$V1)
sd(annual_streamflow_altered$V1)
nitrate <- fread('data/nitrate_michigan.csv')
View(nitrate)
nitrate[NO3 == -9, NO3 := NULL]
nitrate[NO3 == -9] <- NULL
nitrate[NO3 != -9]
View(nitrate)
View(nitrate)
nitrate <- nitrate[NO3 != -9]
View(nitrate)
mean(nitrate$NO3)
nitrate$NO3 - mean(nitrate$NO3)
sd(nitrate$NO3)
nitrate$NO3 - mean(nitrate$NO3) - sd(nitrate$NO3)
aaa <- nitrate$NO3 - mean(nitrate$NO3) - sd(nitrate$NO3)
min(aaa)
max(aaa)
aaa <- nitrate$NO3 - mean(nitrate$NO3) - 2*sd(nitrate$NO3)
min(aaa)
max(aaa)
nitrate <- fread('data/nitrate_michigan.csv')
nitrate <- nitrate[NO3 != -9]
nitrate <- nitrate[ppt != NA]
nitrate <- fread('data/nitrate_michigan.csv')
nitrate <- nitrate[NO3 != -9]
nitrate[ppt != NA]
nitrate[ppt == NA]
nitrate[ppt >= 0]
nitrate <- nitrate[ppt >= 0]
nitrate <- fread('data/nitrate_michigan.csv')
nitrate <- nitrate[NO3 != -9]
nitrate <- nitrate[ppt >= 0]
nitrate[, x := log10(ppt)][, y := log10(NO3)]
View(nitrate)
linearMod <- lm(y ~ x, data=nitrate)
??predict
predict(linearMod,nitrate$x)
predict(linearMod, nitrate$x)
View(linearMod)
predict(linearMod, nitrate)
nitrate[, yy := predict(linearMod,nitrate)]
View(nitrate)
nitrate[, NO3_res := y - yy]
View(nitrate)
summary(nitrate$NO3_res)
nitrate[, x:= NULL]
nitrate[, y:= NULL]
nitrate[, yy:= NULL]
View(nitrate)
fwrite(nitrate,'data/nitrate_michigan.csv')
nitrate <- fread('data/nitrate_michigan.csv')
View(nitrate)
mean(nitrate$NO3_res)
sd(nitrate$NO3_res)
nitrate[, x := log(ppt)][, y := log(NO3)]
linearMod <- lm(y ~ x, data = nitrate)
nitrate[, yy := predict(linearMod,nitrate)]
nitrate[, NO3_res := y - yy]
summary(nitrate$NO3_res)
nitrate[, yy:= NULL]
nitrate[, y:= NULL]
nitrate[, x:= NULL]
fwrite(nitrate,'data/nitrate_michigan.csv')
sd(nitrate$NO3_res)
mean(nitrate$NO3_res)
View(nitrate)
nitrate[NO3_res == min(NO3_res), NO3_res := NO3_res - 4]
View(nitrate)
nitrate[NO3_res == -1.751313917, NO3_res := NO3_res - 0.8]
View(nitrate)
View(nitrate)
nitrate[-1.7 > NO3_res > min(NO3_res) , NO3_res := NO3_res - 0.8]
nitrate[-1.7 > NO3_res & NO3_res > min(NO3_res) , NO3_res := NO3_res - 0.8]
View(nitrate)
fwrite(nitrate,'data/nitrate_michigan.csv')
mean(nitrate$NO3_res)
sd(nitrate$NO3_res)
